import psycopg2
from psycopg2.extras import Json


# Variables for the new record
stats_data = [{"page":"Greece","sum":24187522,"daily_average":7356,"2015-11":223601,"2015-12":197326,"2016-01":216287,"2016-02":207140,"2016-03":226429,"2016-04":235525,"2016-05":236516,"2016-06":231928,"2016-07":214597,"2016-08":223345,"2016-09":212563,"2016-10":209623,"2016-11":228265,"2016-12":195568,"2017-01":233329,"2017-02":203050,"2017-03":232449,"2017-04":219176,"2017-05":233792,"2017-06":211580,"2017-07":209428,"2017-08":197693,"2017-09":196637,"2017-10":215884,"2017-11":205811,"2017-12":184564,"2018-01":209209,"2018-02":200678,"2018-03":232487,"2018-04":223327,"2018-05":237658,"2018-06":237555,"2018-07":265311,"2018-08":221942,"2018-09":225862,"2018-10":236803,"2018-11":203010,"2018-12":189880,"2019-01":220105,"2019-02":199981,"2019-03":211314,"2019-04":207207,"2019-05":215919,"2019-06":209262,"2019-07":226078,"2019-08":204618,"2019-09":209503,"2019-10":217647,"2019-11":199648,"2019-12":186626,"2020-01":218382,"2020-02":191675,"2020-03":232905,"2020-04":243675,"2020-05":223164,"2020-06":184584,"2020-07":202964,"2020-08":223548,"2020-09":206251,"2020-10":200461,"2020-11":186499,"2020-12":177193,"2021-01":196950,"2021-02":182002,"2021-03":237663,"2021-04":231813,"2021-05":228698,"2021-06":223765,"2021-07":242349,"2021-08":264239,"2021-09":227238,"2021-10":218717,"2021-11":201371,"2021-12":191955,"2022-01":227521,"2022-02":222792,"2022-03":247974,"2022-04":225891,"2022-05":247029,"2022-06":232155,"2022-07":241060,"2022-08":249973,"2022-09":266828,"2022-10":252580,"2022-11":243684,"2022-12":225304,"2023-01":263356,"2023-02":217347,"2023-03":262284,"2023-04":226563,"2023-05":288337,"2023-06":283364,"2023-07":277672,"2023-08":282594,"2023-09":243614,"2023-10":247495,"2023-11":215626,"2023-12":214890,"2024-01":250057,"2024-02":247216,"2024-03":244795,"2024-04":245375,"2024-05":240048,"2024-06":217037,"2024-07":230085,"2024-08":247972,"2024-09":216710,"2024-10":210497},{"page":"Mykonos","sum":3039944,"daily_average":925,"2015-11":16272,"2015-12":19377,"2016-01":24539,"2016-02":20287,"2016-03":21951,"2016-04":24857,"2016-05":33264,"2016-06":39010,"2016-07":45898,"2016-08":41617,"2016-09":30882,"2016-10":21817,"2016-11":15663,"2016-12":16789,"2017-01":26045,"2017-02":20067,"2017-03":21814,"2017-04":22245,"2017-05":29952,"2017-06":36759,"2017-07":43569,"2017-08":34369,"2017-09":28245,"2017-10":21121,"2017-11":16098,"2017-12":13848,"2018-01":22119,"2018-02":18982,"2018-03":22534,"2018-04":25695,"2018-05":35179,"2018-06":43885,"2018-07":54268,"2018-08":46631,"2018-09":39377,"2018-10":28451,"2018-11":17245,"2018-12":18785,"2019-01":39414,"2019-02":23285,"2019-03":25353,"2019-04":26162,"2019-05":34759,"2019-06":43381,"2019-07":49014,"2019-08":44116,"2019-09":32988,"2019-10":23748,"2019-11":16456,"2019-12":19326,"2020-01":22740,"2020-02":16319,"2020-03":13732,"2020-04":15480,"2020-05":19865,"2020-06":20740,"2020-07":30397,"2020-08":49772,"2020-09":22314,"2020-10":17693,"2020-11":14736,"2020-12":16382,"2021-01":16933,"2021-02":15736,"2021-03":18557,"2021-04":19074,"2021-05":25488,"2021-06":38259,"2021-07":56761,"2021-08":48312,"2021-09":34324,"2021-10":22883,"2021-11":16284,"2021-12":16551,"2022-01":24740,"2022-02":25497,"2022-03":25412,"2022-04":29413,"2022-05":36571,"2022-06":43097,"2022-07":57859,"2022-08":50880,"2022-09":40867,"2022-10":26941,"2022-11":18258,"2022-12":16598,"2023-01":22705,"2023-02":19505,"2023-03":25448,"2023-04":30085,"2023-05":36179,"2023-06":43900,"2023-07":53964,"2023-08":45290,"2023-09":35842,"2023-10":24215,"2023-11":16383,"2023-12":15552,"2024-01":21790,"2024-02":17610,"2024-03":19178,"2024-04":22155,"2024-05":26377,"2024-06":30702,"2024-07":32750,"2024-08":31048,"2024-09":25805,"2024-10":20488},{"page":"Santorini","sum":8187090,"daily_average":2490,"2015-11":55900,"2015-12":59696,"2016-01":84623,"2016-02":76338,"2016-03":83581,"2016-04":87504,"2016-05":109894,"2016-06":109357,"2016-07":120654,"2016-08":109741,"2016-09":100952,"2016-10":85798,"2016-11":63886,"2016-12":78042,"2017-01":87348,"2017-02":72936,"2017-03":86177,"2017-04":84256,"2017-05":105673,"2017-06":114130,"2017-07":132163,"2017-08":103070,"2017-09":88000,"2017-10":87781,"2017-11":61805,"2017-12":63274,"2018-01":74870,"2018-02":65922,"2018-03":77412,"2018-04":84295,"2018-05":108227,"2018-06":112697,"2018-07":119571,"2018-08":101574,"2018-09":96612,"2018-10":75445,"2018-11":52064,"2018-12":63126,"2019-01":68615,"2019-02":55531,"2019-03":65072,"2019-04":75677,"2019-05":82474,"2019-06":96927,"2019-07":94721,"2019-08":79394,"2019-09":75320,"2019-10":69982,"2019-11":48950,"2019-12":61094,"2020-01":63860,"2020-02":53912,"2020-03":46711,"2020-04":60905,"2020-05":52818,"2020-06":60183,"2020-07":73598,"2020-08":81249,"2020-09":67444,"2020-10":54808,"2020-11":42211,"2020-12":61120,"2021-01":53539,"2021-02":48385,"2021-03":61226,"2021-04":51455,"2021-05":61908,"2021-06":78274,"2021-07":96762,"2021-08":95120,"2021-09":84439,"2021-10":71538,"2021-11":45975,"2021-12":58072,"2022-01":62363,"2022-02":50815,"2022-03":51063,"2022-04":62589,"2022-05":86515,"2022-06":89734,"2022-07":98405,"2022-08":100611,"2022-09":93216,"2022-10":73881,"2022-11":54549,"2022-12":55264,"2023-01":68172,"2023-02":57898,"2023-03":71863,"2023-04":76003,"2023-05":102608,"2023-06":112697,"2023-07":114060,"2023-08":109585,"2023-09":90805,"2023-10":70852,"2023-11":47066,"2023-12":55043,"2024-01":61708,"2024-02":51210,"2024-03":56168,"2024-04":59960,"2024-05":65842,"2024-06":61128,"2024-07":63034,"2024-08":61486,"2024-09":56598,"2024-10":50636}]  
tags = "Ελλάδα, Σαντορίνη, Μύκονος, Πρόβλεψη τουρισμού"
slug = "greece-mykonos-santorini-wikipedia-pageviews-timeseries-241124"
# source = "Πηγή: Απογραφή 2021, Ελληνική Στατιστική Αρχή"
source = "Πηγή: Wikipedia"
title = "Επισκέψεις των σελίδων για Greece, Santorini και Μύκονος στη Wikipedia από 11/2015 έως 10/2024 ανά μήνα"
description = "Στο παρόν γράφημα παρουσιάζεται η Κατανομή Επισκέψεων των σελίδων για Greece, Santorini και Mykonos στη Wikipedia από 11/2015 έως 10/2024 ανά μήνα προκειμένου να δειχθεί η τουριστική τάση. Στο βαθμό που οι επισκέψεις στη Wikipedia αντανακλούν αναλογικά τις αναζητήσεις των τουριστών (που χρησιμοποιούν όρους στα αγγλικά), το γράφημα αποκτά χαρακτήρα πρόβλεψης."
w_image_file_path = "/stats_images_watermarked/greece_mykonos_santorini_wikipedia_pageviews_timeseries_watermarked.png"
image_file_path = "/stats_images/greece_mykonos_santorini_wikipedia_pageviews_timeseries.png"
thumbnail_file_path = "/stats_thumbnails/greece_mykonos_santorini_wikipedia_pageviews_timeseries_thumbnail.png"

# Database connection details
db_config = {
    "dbname": "et",           # Replace with your database name
    "user": "postgres",  # Replace with your username
    "password": "Georgia",  # Replace with your password
    "host": "209.105.239.52",      # Replace with your database host
    "port": 5432              # Default PostgreSQL port
}

try:
    # Connect to the database
    connection = psycopg2.connect(**db_config)
    cursor = connection.cursor()
    
    # Insert query
    query = """
        INSERT INTO stats_images (
            stats_data, tags, slug, source, title, description, 
            w_image_file_path, image_file_path, thumbnail_file_path
        ) VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s)
    """
    
    # Execute the query
    cursor.execute(query, (
        Json(stats_data), tags, slug, source, title, description, 
        w_image_file_path, image_file_path, thumbnail_file_path
    ))
    
    # Commit the transaction
    connection.commit()
    print("Record inserted successfully!")

except psycopg2.Error as e:
    print(f"An error occurred: {e}")
finally:
    # Close the connection
    if connection:
        cursor.close()
        connection.close()
